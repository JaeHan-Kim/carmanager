<!DOCTYPE HTML>
<!-- 현재 스크립트나 CSS 임포트는 각 기능이 있는 위치에 쓰여있기 때문에 
     실제로 사용할 때 정리해서 사용할 것을 권장합니다. -->
<html>
<head>
<title>new 내 차를 부탁해 - 차량 관리입니다.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<script type="application/x-javascript">
	  addEventListener("load", function() { 
	  setTimeout(hideURLbar, 0); }, false); 
	  function hideURLbar(){ 
	  window.scrollTo(0,1); } 
	</script>

	<!-- Bootstrap Core CSS -->
	<link type='text/css' rel='stylesheet' href="../css/main/bootstrap.css" />
	<!-- Custom CSS 메뉴바()메뉴내용, 상단, 차트박스, 글자색 스타일 -->
	<link type='text/css' rel='stylesheet' href="../css/main/style.css" />
	<!-- font CSS -->
	<!-- font-awesome icons 빈칸 유지를 위해 링크를 막아둠 -->
	<!--<link href="../css/main/test/font-awesome.css" rel="stylesheet"> -->
	<!-- //font-awesome icons -->
	<!-- js-->
	<script src="../js/main/jquery-1.11.1.min.js"></script>
	<script src="../js/main/modernizr.custom.js"></script>
	<!--webfonts 없어도 되는듯.. 하지만 삭제 금지-->
	<link type='text/css' rel='stylesheet'
	      href='//fonts.googleapis.com/css?family=Roboto+Condensed:400,300,300italic,400italic,700,700italic'>
	<!--//webfonts-->
  <!-- sweetAlert -->
  <script type="text/javascript" src="../lib/sweetalert/sweetalert.min.js"></script>
  <link rel="stylesheet" type="text/css" href="../lib/sweetalert/sweetalert.css">
	<!--animate-->
	<link type="text/css" rel="stylesheet" media="all" href="../css/main/animate.css" >
	<script src="../js/main/wow.min.js"></script>
	<script>
	  new WOW().init();
	  $(document).ready(function(){ 
	    var userNickname = sessionStorage.getItem('loginUserNickname')+ "님";
	    var userCarNo = sessionStorage.getItem('loginUsercarNo');
	    var userPhoto = sessionStorage.getItem('loginUserPhoto');
	    $("#userNickname").html(userNickname);
      $('#liter').css('display', 'none')
      $('#money').css('display', 'none')
      $("#thumbnail").attr("src", "../img/member/m-" + userPhoto + ".png");
	 });  
	</script>
	<!--//end-animate-->
	
	<!-- chart 챠트 -->
	<script src="../lib/Chart.js/Chart.js"></script>
	<!-- 차트에 날짜 데이터 이용하기 & 주유날짜 등록시 사용 -->
	<script type="text/javascript" src="../js/main/moment_local.js"></script>
	<!-- //chart -->
	
	<!-- Metis Menu -->
	<script src="../js/main/metisMenu.min.js"></script>
	<script src="../js/main/custom.js"></script>
	<link rel="stylesheet" href="../css/main/custom.css">
	<!--//Metis Menu -->
  
  <!-- 달력 선택 -->
  <script src="../js/refuel/simplecalendar.js" type="text/javascript"></script>
  <link rel="stylesheet" href="../css/refuel/refuel.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lato:300,400,700">
  <link rel="stylesheet" href="http://weloveiconfonts.com/api/?family=fontawesome">
  <!-- //달력 선택 -->
</head>

<body class="cbp-spmenu-push">
  <div class="main-content">
    <!--left-fixed -navigation-->
    <div class=" sidebar" role="navigation">
      <div class="navbar-collapse">
        <nav class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left"
          id="cbp-spmenu-s1">
          <ul class="nav" id="side-menu">
            <li>
              <a href="../main/main.html" class="">
              <i class="fa fa-home nav_icon"></i>Dashboard</a>
            </li>
            <li>
              <a href="../mypage/mypage.html" class="">
              <i class="fa fa-home nav_icon"></i>My page</a>
            </li>
            <li>
              <a href="../garage/garage.html" class="">
              <i class="fa fa-home nav_icon"></i>차량 등록</a>
            </li>
            <li>
              <a href="../refuel/refuel.html" class="">
              <i class="fa fa-home nav_icon"></i>차량 관리</a>
            </li>
            <li>
              <a href="../center/center.html" class="">
              <i class="fa fa-home nav_icon"></i>정 비 소</a>
            </li>
            <li>
              <a href="../goods/goods.html" class="">
              <i class="fa fa-home nav_icon"></i>맞춤 서비스</a>
            </li>
            <li>
              <a href="../comunity/comunity.html" class="">
              <i class="fa fa-home nav_icon"></i>커뮤니티</a>
            </li>
          </ul>
          <!-- //sidebar-collapse -->
        </nav>
      </div>
    </div>
    <!--left-fixed -navigation-->

    <!-- header-starts -->
    <div class="sticky-header header-section ">
      <div class="header-left">
        <!--toggle button start-->
        <button id="showLeftPush">
          <img src="../img/main/menu.png">
        </button>
        <!--toggle button end-->
        <!--logo -->
        <div class="logo">
          <a href="../main/main.html">
            <h1>내 차를 부탁해</h1>
            <span>간편, 쉽고, 재밌는 시작!</span>
          </a>
        </div>
        <!--//logo-->

        <!--<div class="clearfix"> </div>-->
      </div>
      <!-- header-left end-->

      <!-- header-right -->
      <div class="header-right">
        <!-- 로그인 유저 정보 -->
        <div class="profile_details">
          <ul>
	          <li class="dropdown profile_details_drop">
	            <a href="#" class="dropdown-toggle" 
	               data-toggle="dropdown" aria-expanded="false">
	              <div class="profile_img">
	                <span class="prfil-img">
	                  <img id ="thumbnail" src="" alt=""> 
	                </span>
	                <div class="user-name">
	                  <p id="userNickname"></p>
	                  <span>안녕하세요.</span>
	                </div>
	                <!-- 빈칸 유지를 위한 아이콘 자리 -->
	                <i class="fa fa-angle-down lnr"></i> 
	                <i class="fa fa-angle-up lnr"></i>
	                <div class="clearfix"></div>
	              </div>
	            </a>
	            <ul class="dropdown-menu drp-mnu">
	              <li><a id="Mypage" href="#"><i class="fa fa-cog"></i>Mypage</a></li>
	              <li><a id="Logout" href="#"><i class="fa fa-sign-out"></i>Logout</a></li>
	            </ul>
	          </li>
          </ul>
        </div>
        <!-- 로그인 유저 정보 end -->
        <div class="clearfix"></div>
      </div>
      <!-- header-right -->
      <div class="clearfix"></div>
    </div>
    <!-- //header-ends -->
     <!-- 로그 아웃 클릭 이벤트 -->
    <script>
    $('#Mypage').click(function(event){
      location.href = "../mypage/mypage.html";
 		});
    
    $('#Logout').click(function(event){
        event.preventDefault();
        sessionStorage.removeItem('loginUserNickname');
        sessionStorage.removeItem('loginUsercarNo');
        location.href = "../auth/login.html";
      });
    </script>
    <!-- main content start-->
    <div id="page-wrapper">
      <div class="main-page">

    <!-- 주유기록 & 소모품 관리 -->
        <div class="forms validation">
          <h3 class="title1">차량 관리를 시작하세요 :</h3>

          <div class="widget_1 row elements">

            <div
              class="col-sm-4 widget_1_box widget-mdl-grid widget-shadow">
              <a href="refuel.html">
                <div class="tile-progress bg-success">
                  <div class="content">
                    <h4>
                      <i class="fa fa-dashboard icon-sm"></i> 주유 기록 등록하기
                    </h4>
                    <span>:&nbsp;&nbsp;자세한 분석을 원하시면 주행거리, 단가를 입력하세요.</span>
                  </div>
                </div>
              </a>
            </div>

            <div
              class="col-sm-4 widget_1_box widget-mdl-grid widget-shadow">
              <a href="refuel_goods.html">
                <div class="tile-progress bg-danger">
                  <div class="content">
                    <h4>
                      <i class="fa fa-dashboard icon-sm"></i> 소모품 관리하기
                    </h4>
                    <span>:&nbsp;&nbsp;주행거리 대비 소모품들 교체 시기를 볼 수 있습니다.</span>
                  </div>
                </div>
              </a>
            </div>
            <div class="clearfix"></div>
          </div>


          <!-- 주유기록 등록 폼 -->
          <div class="row">

            <div class="col-md-6 validation-grids widget-shadow"
              data-example-id="basic-forms">
              <div class="form-title">
                <h4>: 주유 내역을 기록하세요.</h4>
              </div>
              <div class="form-body">
                
                <form method="post" name="addRefuel" data-toggle="validator" novalidate>
                  <div class="form-group">
                    주유 날짜 : <input type="date" name="refuelDate" id="date_refuelDate" class="form-control" placeholder="">
                  </div>
                  <div class="form-group has-feedback">
                    주행거리 : <input type="number" name="mile" id="num_driveMile" class="form-control" placeholder="">
                    <span class="help-block with-errors">
                    현재 주행거리를 입력하세요. 잊으셨다면 저번 주유량을 바탕으로 추정 누적거리를 보여드립니다.</span>
                  </div>
                  <div class="form-group">
                    <div id="sMoney" class="radio">
                      <label> <input type="radio" name="gender" required>단가 + 금액 기록</label>
                    </div>
                    <div id="sLiter" class="radio">
                      <label> <input type="radio" name="gender" required>단가 + 주유량 기록</label>
                    </div>
                    <p>&nbsp;&nbsp;</p>
                      단가 : <input id="num_literCost" name="literCost" type="number" class="form-control" id="inputName" required>
                      <span class="help-block with-errors">
                      단가를 잊으셨나요? 현재 전국평균 가격을 넣어드립니다. 자세한 분석을 원하시면 정확한 가격을 입력하세요.</span>
                    <div id="money" class="form-group">
                      금액 : <input id="num_cost" name="cost" type="number" class="form-control" id="inputName" required>
                    </div>
                    <div id="liter" class="form-group">
                      주유량 : <input id="num_liter" name="liter" type="number" class="form-control" id="inputName" required>
                    </div>
                  </div>

                  <div class="form-group">
                    <button id="btn_addRefuel" type="button" class="btn btn-primary">등록 및 수정하기</button>
                  </div>
                </form>
                
              </div>
            </div>
            <!-- 기록 선택별 input 타입 지정 스트립트 -->
            <script>
              $('#sMoney').click(function(event) {
                $('#money').css('display', '')
                $('#liter').css('display', 'none')
              });
              $('#sLiter').click(function(event) {
                $('#money').css('display', 'none')
                $('#liter').css('display', '')
              });
            </script>
            <!-- 주유기록 등록 스크립트 -->
            <script type="text/javascript">
              var today = moment().format('YYYY-MM-DD');
              var userCarNo = sessionStorage.getItem('loginUsercarNo');
             //  alert(userCarNo); 
              $.getJSON('list.do?no=' + userCarNo, function(resultObj) {
                var ajaxResult = resultObj.ajaxResult;
                var fuelName = ajaxResult.data.fuelName;
               // alert(ajaxResult.data.refuelNo);
                 if (ajaxResult.status == "success") {
                  $("#date_refuelDate").val(today);
                  $("#num_driveMile").val(ajaxResult.data.mile);
                } else {
                  swal("첫 주유 기록이시군요?", "첫 주유기록 이후부터는 편리하게 입력하실 수 있습니다.")
                  $("#date_refuelDate").val(today);
                }
                  $.getJSON('http://localhost:8989/oil', function(resultObj) {
                	/* alert("휘발유 : " + Math.round(resultObj.result.Oil[1].PRICE));
                	alert("경유 : " + Math.round(resultObj.result.Oil[2].PRICE));
                	alert("LGP : " + Math.round(resultObj.result.Oil[4].PRICE)); */
                	if (fuelName == "휘발유") {
                      $("#num_literCost").val(Math.round(resultObj.result.Oil[1].PRICE));
                	} else if (fuelName == "경유") {
                	  $("#num_literCost").val(Math.round(resultObj.result.Oil[2].PRICE));
                	} else {
                	  $("#num_literCost").val(Math.round(resultObj.result.Oil[4].PRICE));
                	}
                  });
              });
            
            </script>
            <!-- 주유 기록 등록 -->
            <script>
            var liter = null;
            var cost = null;
              $("#btn_addRefuel").click(function(event){
                if ($('input:radio[name=gender]')[0].checked) {
                   liter = (Number($('#num_cost').val()) / Number($('#num_literCost').val())).toFixed(2);
                   cost = $('#num_cost').val();
                } else if ($('input:radio[name=gender]')[1].checked) {
				   cost = (Number($('#num_liter').val()) * Number($('#num_literCost').val())).toFixed(0);    
                   liter = $('#num_liter').val();
                }  else {
                  swal("주유량 또는 리터 선택후 기록하세요!");
                }
              $.post('addRefuel.do', {
                  myCarNo: sessionStorage.getItem('loginUsercarNo'),
                  refuelDate: $('#date_refuelDate').val(),
                  mile: $('#num_driveMile').val(),
                  cost: cost,
                  liter: liter,
                  literCost: $('#num_literCost').val()
                }, function(resultObj) {
                  var ajaxResult = resultObj.ajaxResult;
                   if (ajaxResult.status == "success") { 
                    swal({   
                      title: "주유 내역을 기록하였습니다!",   
                      text: "즐거운 이용 되세요.",   
                      type: "success",
                      confirmButtonText: "확인 : )" }, function() {
                         location.href = "refuel.html";
                      });
                   }
                }, 'json');
              });
            </script>
            
            <!-- 달력 폼 시작-->
            <div
              class="col-md-6 validation-grids validation-grids-right">
              <div class="widget-shadow" data-example-id="basic-forms">
                <div class="form-title">
                  <h4>: 주유했던 날을 보여드립니다.</h4>
                </div>
                <div class="form-body">


                  <div class="calendar">
                    <header>
                      <h2 class="month"></h2>
                      <a class="btn-prev fontawesome-angle-left"
                        href="#"></a> <a
                        class="btn-next fontawesome-angle-right"
                        href="#"></a>
                    </header>
                    <table>
                      <thead class="event-days">
                        <tr></tr>
                      </thead>
                      <tbody class="event-calendar">
                        <tr class="1"></tr>
                        <tr class="2"></tr>
                        <tr class="3"></tr>
                        <tr class="4"></tr>
                        <tr class="5"></tr>
                      </tbody>
                    </table>
                    
                    <div class="list">
                      <div class="day-event" date-month="1" date-day="25" date-year="2016"  data-number="2"></div>
                      <!-- <h2 class="title">데이터2</h2>
                      <p class="date">2014-12-13</p>
                      <p>Lorem Ipsum är en utfyllnadstext från tryck- och förlagsindustrin. Lorem ipsum har varit standard ända sedan 1500-talet, när en okänd boksättare tog att antal bokstäver och blandade dem för att göra ett provexemplar av en bok.</p>
                      <label class="check-btn">
                      <input type="checkbox" class="save" id="save" name="" value=""/>
                      <span>Save to personal list!</span>
                      </label> -->
                    </div>

                  </div>


                </div>
              </div>

            </div>
            <div class="clearfix"></div>

          </div>

        </div>





      </div>
    </div>
    <!--footer-->
    <div class="footer">
      <p>
        &copy; 2016 Java76th 태웅 재한 영호 다인. All Rights Reserved | Project by <a href="" target="_blank">내 차를 부탁해</a>
      </p>
    </div>
    <!--//footer-->
  </div>

  <!-- Classie 메뉴 접히고 펼쳐지는 부분` -->
  <script src="../js/main/classie.js"></script>
  <script>
    var menuLeft = document.getElementById('cbp-spmenu-s1'), 
        showLeftPush = document.getElementById('showLeftPush'), 
        body = document.body;

    showLeftPush.onclick = function() {
      classie.toggle(this, 'active');
      classie.toggle(body, 'cbp-spmenu-push-toright');
      classie.toggle(menuLeft, 'cbp-spmenu-open');
      disableOther('showLeftPush');
    };

    function disableOther(button) {
      if (button !== 'showLeftPush') {
        classie.toggle(showLeftPush, 'disabled');
      }
    }
  </script>
  <!--scrolling js 스크롤바 조정-->
  <script src="../js/main/jquery.nicescroll.js"></script>
  <script src="../js/main/scripts.js"></script>
  <!--//scrolling js-->
  <!-- Bootstrap Core JavaScript -->
  <script src="../js/main/bootstrap.js"></script>
</body>
</html>