<!DOCTYPE HTML>
<html>
<head>
<title>내 차를 부탁해 - 메인 페이지</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords"
  content="Novus Admin Panel Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template, 
SmartPhone Compatible web template, free WebDesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
<script type="application/x-javascript">
  
  
   
addEventListener("load", function() { 
setTimeout(hideURLbar, 0); }, false); 
function hideURLbar(){ 
window.scrollTo(0,1); } 

</script>
<!-- Bootstrap Core CSS -->
<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
<link href="../css/main/bootstrap.css" rel='stylesheet' type='text/css' />
<link href="../css/main/main.css" rel='stylesheet' type='text/css' />
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.css" rel="stylesheet">
<!-- Custom CSS 메뉴바()메뉴내용, 상단, 차트박스, 글자색 스타일 -->
<link href="../css/main/style.css" rel='stylesheet' type='text/css' />
<!-- font CSS -->
<!-- font-awesome icons 빈칸 유지를 위해 링크를 막아둠 -->
<!--<link href="../css/main/test/font-awesome.css" rel="stylesheet"> -->
<!-- //font-awesome icons -->
<!-- js-->
<script src="../js/main/jquery-1.11.1.min.js"></script>
<!-- sweetAlert -->
<script type="text/javascript" src="../lib/sweetalert/sweetalert.min.js"></script> 
<link rel="stylesheet" type="text/css" href="../lib/sweetalert/sweetalert.css">

<script src="../js/main/modernizr.custom.js"></script>
<!--webfonts 없어도 되는듯..? -->
<link href='//fonts.googleapis.com/css?family=Roboto+Condensed:400,300,300italic,400italic,700,700italic'
  rel='stylesheet' type='text/css'>
<!--//webfonts-->
<!--animate-->
<link href="../css/main/animate.css" rel="stylesheet" type="text/css"
  media="all">
<!-- Go.js -->
<script src="../js/main/go.js"></script>
<script src="../js/main/wow.min.js"></script>

<script>
  new WOW().init();
  $(document).ready(function(){
    if (sessionStorage.getItem('loginUserNickname') == null) {
      location.href = "../auth/login.html";
    }
    $('#blank').css('display', 'none')
    $('#exCar').css('display', 'none')
    var userNickname = sessionStorage.getItem('loginUserNickname')+ "님";
    var userCarNo = sessionStorage.getItem('selectCarNo');
    var userPhoto = sessionStorage.getItem('loginUserPhoto');
    $("#userNickname").html(userNickname);
    $("#thumbnail").attr("src", "../img/member/m-" + userPhoto + ".png");
    if (userCarNo == 0) {
      $('#blank').css('display', '')
      $('#exCar').css('display', 'none')
    } else {
      $('#exCar').css('display', '')
      $('#blank').css('display', 'none')
    }
 });  
</script>
<!--//end-animate-->

<!-- chart 챠트 -->
<script src="../lib/Chart.js/Chart.js"></script>
<!-- 차트에 날짜 데이터 이용하기 -->
<script src="../js/main/moment_local.js" type="text/javascript"></script>

<script src="../js/main/d3.min.js" language="JavaScript"></script>
<script src="../js/main/liquidFillGauge.js" language="JavaScript"></script>

<style>
    .liquidFillGaugeText { font-family: Helvetica; font-weight: bold; }
</style>
<!-- //chart -->

<!--Calender-->
<!--<link rel="stylesheet" href="css/clndr.css" type="text/css" />
<script src="js/underscore-min.js" type="text/javascript"></script>
<script src= "js/moment-2.2.1.js" type="text/javascript"></script>
<script src="js/clndr.js" type="text/javascript"></script>
<script src="js/site.js" type="text/javascript"></script>-->
<!--End Calender-->
<!-- Metis Menu -->
<script src="../js/main/metisMenu.min.js"></script>
<script src="../js/main/custom.js"></script>
<link href="../css/main/custom.css" rel="stylesheet">
<!--//Metis Menu -->
</head>
<body class="cbp-spmenu-push">
  <div class="main-content">
    <!--left-fixed -navigation-->
    <div class=" sidebar" role="navigation">
      <div class="navbar-collapse">
        <nav class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left"
          id="cbp-spmenu-s1">
          <ul class="nav" id="side-menu">
            <li><a href="../main/main.html" class=""><i class="nav_icon"></i><img class="img_menu" src="../img/main/dash.png">Dashboard</a></li>
            <li><a href="../mypage/mypage.html" class=""><i class="nav_icon"></i><img class="img_menu" src="../img/main/mypage.png">My page</a></li>
            <li><a href="../garage/garage.html" class=""><i class="nav_icon"></i><img class="img_menu" src="../img/main/garage.png">차량 등록</a></li>
            <li><a href="../refuel/refuelManager.html" class=""><i class="nav_icon"></i><img class="img_menu" src="../img/main/refuel.png">차량 관리</a></li>
            <li><a href="../center/center.html" class=""><i class="nav_icon"></i><img class="img_menu" src="../img/main/center.png">정 비 소</a></li>
            <li><a href="../goods/goods.html" class=""><i class="nav_icon"></i><img class="img_menu" src="../img/main/goods.png">맞춤 서비스</a></li>
            <li><a href="../community/community.html" class=""><i class="nav_icon"></i><img class="img_menu" src="../img/main/community.png">커뮤니티</a></li>
          </ul>
          <!-- //sidebar-collapse -->
        </nav>
      </div>
    </div>
    <!--left-fixed -navigation-->

    <!-- header-starts -->
    <div class="sticky-header header-section ">
      <div class="header-left">
        <!--toggle button start-->
        <button id="showLeftPush">
          <img class="img_menubtn" src="../img/main/menu.png">
        </button>
        <!--toggle button end-->
        <!--logo -->
        <div class="logo">
          <a href="../main/main.html">
            <h1>내 차를 부탁해</h1> <span>간편, 쉽고, 재밌는 시작!</span>
          </a>
        </div>
        <!--//logo-->
        <!--search-box-->
        <!--<div class="search-box">
          <form class="input">
            <input class="sb-search-input input__field--madoka" placeholder="Search..." type="search" id="input-31" />
            <label class="input__label" for="input-31">
              <svg class="graphic" width="100%" height="100%" viewBox="0 0 404 77" preserveAspectRatio="none">
                <path d="m0,0l404,0l0,77l-404,0l0,-77z"/>
              </svg>
            </label>
          </form>
        </div>
        <!-- end-search-box-->
        <div class="clearfix"> </div>
      </div>
      <!-- header-left end-->

      <!-- header-right -->
      <div class="header-right">
        <!-- <!-- 유저별 차량 리스트 -->
         
        <!-- 유저별 차량 리스트 end -->

        <!-- 로그인 유저 정보 -->
        <div class="profile_details">
          <ul>
            <li class="dropdown profile_details_drop">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                <div class="profile_img">
                  <span class="prfil-img">
                    <img id="thumbnail" class="img-rounded" src="" alt="">
                  </span>
                  <div class="user-name">
                    <p id="userNickname"></p>
                    <span>반갑습니다 : )</span>
                  </div>
                  <!-- 빈칸 유지를 위한 아이콘 자리 -->
                  <i class="fa fa-angle-down lnr"></i>
                  <i class="fa fa-angle-up lnr"></i>
                  <div class="clearfix"></div>
                </div>
            </a>
              <!-- 유저별 차량 리스트 -->
              <ul id="myCarList" class="dropdown-menu drp-mnu">
              </ul>
              <!-- 유저별 차량 리스트 end -->
            </li>
          </ul>
       </div>
        <!-- 로그인 유저 정보 end -->
        <div class="clearfix"></div>
      </div>
      <!-- header-right -->
      <div class="clearfix"></div>
    </div>
    <!-- //header-ends -->
    <!--   로그 아웃 클릭 이벤트 -->
    <!-- main content start-->
    <div id="page-wrapper">
      <div class="main-page">
         
         <!-- 차량 정보가 없을 때 시작 페이지 -->
         <div id="blank" class="media">
          <h2 class="title1">반갑습니다 : ) 처음이신가요?</h2>
          <div class="bs-example5 widget-shadow"
            data-example-id="default-media">

            <div class="media">
              <div class="media-left">
                <a href="#"> <img class="media-object"
                  data-src="holder.js/64x64" alt="64x64"
                  src="../img/main/simple.png"
                  data-holder-rendered="true"
                  style="width: 250px; height: 150px;">
                </a>
              </div>
              <div class="media-body">
                <h3 class="media-heading">간편 합니다. 먼저 차량을 등록하세요!</h3>
                <h4>누적거리를 잊으셨나요? 리터당 얼마에 넣었는지 깜빡하셨다구요? 걱정마세요. 처음 주유
                  기록을 바탕으로 추정 누적거리를 입력해 드리고, 전국 평균 단가를 넣어 번거로움을 최소화 시켜
                  드립니다.</h4>
              </div>
              <div class="clearfix"></div>
            </div>

            <div class="media">
              <div class="media-body">
                <h3 class="media-heading">매우 쉬워요. 차량 등록을 하셨나요? 그러면
                  주유 기록을 등록해 보세요.</h3>
                <h4>꾸준한 차량 관리를 위해서 용어를 찾아 해맨 당신, '내 차를 부탁해'에서는 왼쪽
                  메뉴에서 바로 들어가 등록하고 직관적으로 보여드립니다.</h4>
              </div>
              <div class="media-right">
                <a href="#"> <img class="media-object"
                  data-src="holder.js/64x64" alt="64x64"
                  src="../img/main/easy.png" data-holder-rendered="true"
                  style="width: 150px; height: 150px;">
                </a>
              </div>
            </div>

            <div class="media">
              <div class="media-left">
                <a href="#"> <img class="media-object"
                  data-src="holder.js/64x64" alt="64x64"
                  src="../img/main/fun.png" data-holder-rendered="true"
                  style="width: 250px; height: 150px;">
                </a>
              </div>
              <div class="media-body">
                <h3 class="media-heading">재미있어요!</h3>
                <h4>주유기록, 소모품 기록을 보기 위해 돌아다니지 마세요. DashBoard에서 눈에 쏙
                  들어오는 차트를 확인하고 교체시기가 다가오는 부품은 차량 이미지로 재밌게 알 수 있습니다.</h4>
              </div>
              <!--<div class="clearfix"> </div>-->
            </div>

            <div class="media">
              <div class="media-body">
                <h3 class="media-heading">아주 유용합니다.</h3>
                <h4>근처에 있는 차량 서비스센터 안내, 소모품 최저가 안내 및 공유 등 필요한 정보만
                  담았습니다. 지금 이용해 보세요!</h4>
              </div>
              <div class="media-right">
                <a href="#"> <img class="media-object"
                  data-src="holder.js/64x64" alt="64x64"
                  src="../img/main/usefull.png"
                  data-holder-rendered="true"
                  style="width: 250px; height: 150px;">
                </a>
              </div>
            </div>

          </div>

          <!--<div class="clearfix"> </div>-->
        </div>
        <!-- 차량 정보 없을 때 시작페이지 끝 -->

        <!-- 차트 위 택스트 차량 정보 있을 때 -->
       <div id="exCar">
       <h3 class="title1">기록한 내용을 바탕으로 종합정보를 확인하세요 :</h3>
       <h4><span id="selectedMyCar"></span>의&nbsp;&nbsp;월별 주유금액, 연비 개선율, 연비 비교, 교체할 소모품을 알려드립니다.</h4>
        
        <!-- 차트 시작 -->
        <div class="charts">
          <div class="col-md-4 charts-grids widget">
            <h4 class="title">월별 주유 금액 입니다.</h4>
            <div id="topL"></div>
            <canvas id="bar" height="300" width="400"> </canvas>
            <div id="bar-legend" class="chart-legend"></div>
          </div>
          
          <div class="col-md-4 charts-grids widget states-mdl">
            <h4 class="title">최근 구간 연비 개선율 입니다.</h4>
            <div id="topM"></div>
            <svg id="efficgauge"></svg>
            <div id="circle-legend" class="chart-legend"></div>
          </div>
          
          <div class="col-md-4 charts-grids widget">
            <h4 class="title">공인 연비 대비 연비 입니다.</h4>
            <div id="topR"></div>            
            <canvas id="line" height="300" width="400"> </canvas>
       		 <div id="line-legend" class="chart-legend"></div>
          </div>
          <div class="clearfix"></div>

          <script>
        </script>

        </div>
        <!-- 차트 끝 -->
        
        <!-- 소모품 안내 시작 -->
        <div class="row calender widget-shadow">
          <h4 class="title">교체 시기가 다가오는 소모품을 확인하세요.</h4>
          <div class="cal1">
						<div id="myDiagramDiv" class="well" style="width: auto; height: 300px;"></div>
        	  <span id="diagramEventsMsg"></span>
          	<div class="clearfix"></div>
          </div>
        </div>
        <div class="clearfix"></div>
        <!-- /소모품 안내 끝 -->
      
      </div>

      </div>
    </div>    
    <script id="code">
    var selectcar = $("#myCarList");
    var cnt = 0;
    var lifeTime = [0, 8000, 5000, 30000, 45000, 40000, 10000, 50000, 60000, 60000];
    $.getJSON('../main/list.do?no=' + sessionStorage.getItem("loginUser") + '&carNo='+sessionStorage.getItem("selectCarNo"), function(resultObj) {
      for (var garage of resultObj.data) {
        if (sessionStorage.getItem("selectCarNo") == garage.myCarNo) {
          $('#selectedMyCar').html(garage.nickName);
        }
        $("<li><a class='link' href='#' carNo = '"+ garage.myCarNo +"' carName = '"+ garage.nickName +"'><i class='nav_icon'></i><img class='img_mycar' src='../img/main/mycar.png'>"+ garage.nickName +"</a></li>").appendTo('#myCarList');
     	} 
      $("<li><a class='link' carNo = 'Logout' href='#'><i class='nav_icon'></i><img class='img_logout' src='../img/main/logout.png'>Logout</a></li>").appendTo('#myCarList');
      $("a.link").click(clickLink);
     lineChart(resultObj);
     barChart(resultObj);
     displayEffiChart(resultObj);
    
   });
    
    $.post('../mygoods/selectCurrentMile.do', {
      no: sessionStorage.getItem("selectCarNo")
    }, function(resultObj) {
      if (resultObj.status == "success") {
       	var userRatio = new Array();

    	  for (var i=1; i <= 9; i++) {
    	    userRatio.push(parseInt(((lifeTime[i]-resultObj.data[i])/lifeTime[i]) * 100));
    	  }
    	  goIntro(userRatio);
      }
    }, 'json')
    function clickLink(event) {
      event.preventDefault();
      if ($(event.target).attr("carNo") == 'Logout') {
          sessionStorage.removeItem('loginUserNickname');
      /*  sessionStorage.removeItem('loginUsercarNo'); */
          sessionStorage.removeItem('loginUserPhoto');
          sessionStorage.removeItem('selectCarNo');
          location.href = "../auth/login.html";
      } else {
        $('#selectedMyCar').html($(this).attr("carName"));
        sessionStorage.setItem('selectCarNo', $(this).attr("carNo"));
        changeMyCar(sessionStorage.getItem("selectCarNo"));
      }
        
    }
    
    function changeMyCar(selectCarNo){
      $("#line").remove();
      $("#bar").remove();
      $("#efficgauge").remove();
      $("#myDiagramDiv").remove();
      $("#diagramEventsMsg").remove();
      $.getJSON('list.do?no=' + sessionStorage.getItem("loginUser") + '&carNo='+selectCarNo, 
          function(resultObj) {
            $("<canvas id='bar' height='400' width='450'></canvas>").appendTo("#topL");
            $("<canvas id='line' height='400' width='450'></canvas>").appendTo("#topR");
            $("<svg id='efficgauge'></svg>").appendTo("#topM");
            lineChart(resultObj);
            barChart(resultObj);
            displayEffiChart(resultObj);
          });
      
      $.post('../mygoods/selectCurrentMile.do', {
	      no: sessionStorage.getItem("selectCarNo")
	    }, function(resultObj) {
	      var userRatio = new Array();
	      if (resultObj.status == "success") {
	        $("<div id='myDiagramDiv' class='well' style='width: auto; height: 400px;'></div>").appendTo(".cal1");
          $("<span id='diagramEventsMsg'></span>").appendTo(".cal1");
	    	  for (var i=1; i <= 9; i++) {
	    	    userRatio.push(parseInt(((lifeTime[i]-resultObj.data[i])/lifeTime[i]) * 100));
	    	  }
	    	 
	    	  goIntro(userRatio);
	      }
	    }, 'json')
    }

  function lineChart(resultObj) {
    var effic = new Array();
    var offiEffi = new Array();
    var driveDt = new Array();
    if (resultObj.refuelList != "" && resultObj.refuelList.length >= 2 ) {
      for (var i = resultObj.refuelList.length-1; i > 0; i--) {
       effic.push(((resultObj.refuelList[i-1].mile-resultObj.refuelList[i].mile)/resultObj.refuelList[i].liter).toFixed(2));
        offiEffi.push(resultObj.refuelList[0].effi);
        driveDt.push(resultObj.refuelList[i-1].group_date) 
       }
    } else {
      var canvas = document.getElementById("line");
      var ctx = canvas.getContext("2d");
      ctx.font = "25px Arial";
      ctx.fillText("최소 3개 이상의 기록이 필요합니다.",30,100);
      return;
    }
      var lineChartData = {
        labels : driveDt,
        datasets : [
          {
            label: "구간연비",
            fillColor : "rgba(255,140,0,0.4)",
            strokeColor : "rgba(255,140,0,1)",
            pointColor : "rgba(255,140,0,1)",
            pointStrokeColor : "#fff",
            pointHighlightFill : "#fff",
            pointHighlightStroke : "rgba(220,220,220,1)",
            data :  effic
          },
          {
            label: "공인연비",
            fillColor : "rgba(105,105,105,0.2)",
            strokeColor : "rgba(105,105,105,1)",
            pointColor : "rgba(105,105,105,1)",
            pointStrokeColor : "#fff",
            pointHighlightFill : "#fff",
            pointHighlightStroke : "rgba(151,187,205,1)",
            data : offiEffi
          }
        ]
    
      }
    var ctx1 = document.getElementById("line").getContext("2d");
    myLine = new Chart(ctx1).Line(lineChartData, {
      responsive: true,
      legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\">"+
      "<% for (var i=0; i<datasets.length; i++){%>"+
        "<li><span style=\"background-color:<%=datasets[i].strokeColor%>\"></span>"+
        "<%if(datasets[i].label){%><%=datasets[i].label%><%}%>"+
        "</li><%}%>"+
        "(단위: Km)</ul>"
    });
    document.getElementById('line-legend').innerHTML = myLine.generateLegend();
    }
  
  function barChart(resultObj) {
    var month = new Array();
    var memCostAvg = new Array();
    var myCostAvg = new Array();
    month.push((moment().subtract(60, 'days').months() + 1) + "월");
    month.push((moment().subtract(30, 'days').months() + 1) + "월");
    month.push(moment().format('MM')  + "월");
   
 	for (var i = resultObj.memCostAvg.length-1; i >= 0; i-- ) {
 		memCostAvg.push((resultObj.memCostAvg[i].cost/=1000).toFixed(2));
  } 
 	if (resultObj.myCostAvg.length == 3) {
 	 for (var i = resultObj.myCostAvg.length-1; i >= 0; i-- ) {
	    myCostAvg.push((resultObj.myCostAvg[i].cost/=1000).toFixed(2));
 	} 
 	} else if (resultObj.myCostAvg.length == 2) {
 	 for (var i = resultObj.myCostAvg.length-1; i >= 0; i-- ) {
     myCostAvg.push((resultObj.myCostAvg[i].cost/=1000).toFixed(2));
	 } 
 	myCostAvg.push(0);
 	} else if (resultObj.myCostAvg.length == 1) {
 	 	myCostAvg.push(0);
 	 	myCostAvg.push(0);
 	 for (var i = resultObj.myCostAvg.length-1; i >= 0; i-- ) {
	   myCostAvg.push((resultObj.myCostAvg[i].cost/=1000).toFixed(2));
  } 
 	} else {
 		myCostAvg.push(0);
 		myCostAvg.push(0);
	 	myCostAvg.push(0);
 	}
	
         var barChartData = {
           labels : month,
           datasets : [
             {
               label: "회원평균",
               fillColor : "#E86C6C",
               strokeColor : "#E86C6C",
               highlightFill: "#e94e02",
               highlightStroke: "#e94e02",
               data : memCostAvg
             },
             {
               label: "개인평균",
               fillColor : "#759CD0",
               strokeColor : "#759CD0",
               highlightFill: "#4F52BA",
               highlightStroke: "#4F52BA",
               data : myCostAvg
             }
           ]
         };
      var ctx = document.getElementById("bar").getContext("2d");
      var myBar = new Chart(ctx).Bar(barChartData, {
      responsive : true,
      datasetStroke : true,
      legendTemplate : 
        "<ul class=\"<%=name.toLowerCase()%>-legend\">"+
      	"<% for (var i=0; i<datasets.length; i++){%>"+
      	"<li><span style=\"background-color:<%=datasets[i].fillColor%>\"></span>"+
      	"<%if(datasets[i].label){%><%=datasets[i].label%><%}%>"+
      	"</li><%}%>"+
      	"(단위: 천원)</ul>"

      });
      document.getElementById('bar-legend').innerHTML = myBar.generateLegend();
    }
  
    function displayEffiChart(resultObj) {
      var w = $("#line").width(), h = $("#line").height();
      
      var svg = d3.select("#efficgauge")
      						.attr("width", w)
      						.attr("height", h);
      
      var effic = new Array();
      
      if (resultObj.refuelList != ""  && resultObj.refuelList.length > 2) {
        for (var i = 0; i < 3; i++) {
          effic[i] = ((resultObj.refuelList[i].mile-resultObj.refuelList[i+1].mile)/resultObj.refuelList[i+1].liter).toFixed(2);
        }

          var efficper = Math.round(((effic[0]-effic[1])/effic[1])*100); 
          
					if (efficper > 50) {
						efficper = 50;
					} else if (efficper < -50) {
						efficper = -50;
					}         
          
        	if (efficper < 0) {
        		var config = liquidFillGaugeDefaultSettings();
            config.circleThickness = 0.1;
            config.circleColor = "#DC143C";
            config.textColor = "#8B0000";
            config.waveColor = "#F7464A";
            config.textVertPosition = 0.8;
            config.waveAnimateTime = 1000;
            config.waveHeight = 0.05;
            config.waveAnimate = true;
            config.waveHeightScaling = false;
            config.waveOffset = 0.25;
            config.textSize = 0.75;
            config.waveCount = 3;
            
            loadLiquidFillGauge("efficgauge", Math.abs(efficper), config, efficper);
        	} else {
	        	var config = liquidFillGaugeDefaultSettings();
	        	config.circleThickness = 0.1;
	        	config.circleColor = "#008080";
	        	config.textColor = "#006400";
	        	config.waveColor = "#46BFBD";
	        	config.textVertPosition = 0.8;
	        	config.waveAnimateTime = 1000;
            config.waveHeight = 0.05;
            config.waveAnimate = true;
            config.waveHeightScaling = false;
            config.waveOffset = 0.25;
            config.textSize = 0.75;
            config.waveCount = 3;
            
            loadLiquidFillGauge("efficgauge", efficper, config, efficper);
	        }
    	
      } else {
    	  
        	var config = liquidFillGaugeDefaultSettings();
        	config.circleThickness = 0.1;
        	config.circleColor = "#008080";
        	config.textColor = "#006400";
        	config.waveColor = "#46BFBD";
        	config.textVertPosition = 0.8;
        	config.waveAnimateTime = 1000;
	        config.waveHeight = 0.05;
	        config.waveAnimate = true;
	        config.waveHeightScaling = false;
	        config.waveOffset = 0.25;
	        config.textSize = 0.75;
	        config.waveCount = 3;
        
        loadLiquidFillGauge("efficgauge", 0, config, 0);
    	}
      
      document.getElementById('circle-legend').innerHTML = 
    	  "<ul>"+
          "<li><span style=\"background-color:#008080\"></span>"+
               "<lable>개선율 증가<label></li>" + 
          "<li><span style=\"background-color:#F7464A\"></span>"+
               "<lable>개선율 감소<label></li>"+
          "(최대:50% ~ 최소:-50%)" + 
        "</ul>";
      
      svg.call(responsivefy);         // rsponsive 처리 

      $("#efficgauge").height($("#line").height());
    }
  
  
	
  	function goIntro(userRatio) {
  	 	var temp, indexMin; 
    	var repalecePart = 0;
    	var ct = 0;
    	var message = "교체 필요 부품 : ";
    	var partName = ['와이퍼', '에어컨 필터', '브레이크 패드', '브레이크 오일', '부동액', '엔진오일', '미션오일', '타이어', '베터리'];
    	var partImage = ['../img/refuel/refuel_goods/wiper.png', 
    	                 '../img/refuel/refuel_goods/filter.png', 
    	                 '../img/refuel/refuel_goods/breakpad.png', 
    	                 '../img/refuel/refuel_goods/breakoil.png', 
    	                 '../img/refuel/refuel_goods/coolant.png', 
    	                 '../img/refuel/refuel_goods/engine.png', 
    	                 '../img/refuel/refuel_goods/missionoil.png', 
    	                 '../img/refuel/refuel_goods/tire.png', 
    	                 '../img/refuel/refuel_goods/battery.png'];
      for (var i = 0; i < userRatio.length - 1; i++) {
        indexMin = i;
        for (var j = i + 1; j < userRatio.length; j++) {
            if (userRatio[j] > userRatio[indexMin]) {
                indexMin = j;
            }
        }
        temp = userRatio[indexMin];
        userRatio[indexMin] = userRatio[i];
        userRatio[i] = temp;
        // -------------------------------
        temp = partName[indexMin];
        partName[indexMin] = partName[i];
        partName[i] = temp;
     		// -------------------------------
        temp = partImage[indexMin];
        partImage[indexMin] = partImage[i];
        partImage[i] = temp;
    }
    	  var $ = go.GraphObject.make;
    	  
    	  var diagram = $(go.Diagram, "myDiagramDiv",
    	    {
    	    	autoScale: go.Diagram.Uniform,
    	    	allowSelect: false,
    	    	allowCopy: false,
    	    	allowDelete: false,
    	    	allowMove: false,
    	    	contentAlignment: go.Spot.Center,
    	    	allowVerticalScroll: false
    	  	});
    	  function showMessage(s) {
    	    document.getElementById("diagramEventsMsg").textContent = s;
    	  }
    	  /* diagram.addDiagramListener("ObjectSingleClicked",
    	      function(e) {
    	        var part = e.subject.part;
    	        if (!(part instanceof go.Link)) showMessage("Clicked on " + part.data.key);
    	      });
    	  diagram.addDiagramListener("BackgroundDoubleClicked",
    	      function(e) { showMessage("Double-clicked at " + e.diagram.lastInput.documentPoint); });
         */
        diagram.nodeTemplate =
    	    $(go.Node, "Spot",
    	      new go.Binding("location", "loc"),
    	         
    	      $(go.Picture, 
    	          {maxSize: new go.Size(100, 100)},
    	        new go.Binding("maxSize", "maxSize"),
    	        new go.Binding("source", "img"),
              new go.Binding("stroke", "color"),
  	          new go.Binding("strokeWidth", "width"),
  	          new go.Binding("strokeDashArray", "dash")
              ),
    	      $(go.TextBlock,
    	        { margin: new go.Margin(3, 0, 0, 0),
    	          maxSize: new go.Size(100, 30),
    	          isMultiline: false })
    	    );
        diagram.linkTemplate = $(go.Link,
            { curve: go.Link.Bezier },
            $(go.Shape,
                new go.Binding("stroke", "color"),
                new go.Binding("strokeWidth", "width"),
                new go.Binding("strokeDashArray", "dash"))
            );
  			
        var posX = [-400, -400, -400, 400, 400, 400];
        var posY = [200, 0, -200, 200, 0, -200];
    
         var nodeDataArray = new Array();
         var linkDataArray = new Array();
    for (var i = 0; i < userRatio.length; i++) {
      if (userRatio[i] >= 80) {
        message += partName[i] + " , ";
      }
    }
  	for (var j = 0; j < userRatio.length; j++){
  	  if (ct == 6) {
  	    break;
  	  } 
  		if (userRatio[j] >= 80) {
  		  ct++
  			nodeDataArray.push({ "key": partName[j], "img": partImage[j], "loc": new go.Point(posX[j], posY[j])});
  			linkDataArray.push({ from: 'car', to: partName[j], dash: [11, 10], color: 'crimson', width: 2});
  		} 
  	}
  	var carStatus;
  	var size = 700;
    if (ct < 2) {
      carStatus = "carG.png";
    } else if (ct < 4) {
      carStatus = "carO.png";
    } else {
      carStatus = "carR.png";
    }
    showMessage(message.substring(0,message.lastIndexOf(',')));
    nodeDataArray.push({ "maxSize": new go.Size(400, 500), "key": "car", "img": carStatus, "loc": new go.Point(-150, -100) });
  	diagram.model = new go.GraphLinksModel(nodeDataArray, linkDataArray);

  	} 
    </script>
    <!--footer-->
    <div class="footer">
      <p>
        &copy; 2016 Java76th 태웅 재한 영호 다인. All Rights Reserved | Project
        by <a href="" target="_blank">내 차를 부탁해</a>
      </p>
    </div>
    <!--//footer-->
  </div>

  <!-- Classie 메뉴 접히고 펼쳐지는 부분` -->
  <script src="../js/main/classie.js"></script>
  <script>
      var menuLeft = document.getElementById('cbp-spmenu-s1'), showLeftPush = document
          .getElementById('showLeftPush'), body = document.body;

      showLeftPush.onclick = function() {
        classie.toggle(this, 'active');
        classie.toggle(body, 'cbp-spmenu-push-toright');
        classie.toggle(menuLeft, 'cbp-spmenu-open');
        disableOther('showLeftPush');
      };

      function disableOther(button) {
        if (button !== 'showLeftPush') {
          classie.toggle(showLeftPush, 'disabled');
        }
      }
    </script>
  <!--scrolling js 스크롤바 조정-->
  <script src="../js/main/jquery.nicescroll.js"></script>
  <script src="../js/main/scripts.js"></script>
  <!--//scrolling js-->
  <!-- Bootstrap Core JavaScript -->
  <script src="../js/main/bootstrap.js">
      
    </script>
</body>
</html>