<!DOCTYPE HTML>
<!-- 현재 스크립트나 CSS 임포트는 각 기능이 있는 위치에 쓰여있기 때문에 
     실제로 사용할 때 정리해서 사용할 것을 권장합니다. -->
<html class="no-js">
<head>
<title>new 내 차를 부탁해</title>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link type='text/css' rel="stylesheet" href="../css/community/cstyle.css">
  <link type='text/css' rel="stylesheet" href="../css/community/jquery.jscrollpane.css">
  <link type='text/css' rel='stylesheet' href="../lib/bootstrap/css/bootstrap.css" />
  <link type="text/css" rel="stylesheet" media="all" href="../css/main/animate.css" >
  <link type="text/css" rel="stylesheet" href="../css/main/custom.css">
  <link type='text/css' rel='stylesheet' href="../css/main/style.css" />
  <link type='text/css' rel='stylesheet' 
        href='http://fonts.googleapis.com/css?family=PT+Sans:400,700'>
  <link type='text/css' rel='stylesheet'
        href='http://fonts.googleapis.com/css?family=Roboto+Condensed:400,300,300italic,400italic,700,700italic'>
  <link type='text/css' rel='stylesheet' 
        href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow&v1' />
  <link type='text/css' rel='stylesheet' 
        href='http://fonts.googleapis.com/css?family=Oswald' />
  <link type='text/css' rel='stylesheet' 
        href='http://fonts.googleapis.com/css?family=Ovo' />

	<script src="../lib/jquery/jquery.min.js"></script>
  <script src="../lib/bootstrap/js/bootstrap.min.js"></script>
  <script src="../js/main/classie.js"></script>
  <script src="../js/main/custom.js"></script>
  <script src="../js/main/jquery.nicescroll.js"></script>
  <script src="../js/main/metisMenu.min.js"></script>
	<script src="../js/main/modernizr.custom.js"></script>
  <script src="../js/main/moment_local.js"></script>
  <script src="../js/main/scripts.js"></script>
	<script src="../js/main/wow.min.js"></script>
	<script src="../js/community/jquery.tmpl.min.js"></script>
	<script src="../js/community/jquery.easing.1.3.js"></script>
	<script src="../js/community/jquery.mousewheel.js"></script>
	<script src="../js/community/jquery.jscrollpane.min.js"></script>
	<script src="../js/community/jquery.masonry.min.js"></script>
	<script src="../js/community/jquery.gpCarousel.js"></script>

	<script type="application/x-javascript">
	  addEventListener("load", function() { 
	  setTimeout(hideURLbar, 0); }, false); 
	  function hideURLbar(){ 
	  window.scrollTo(0,1); } 
	</script>

	<script>
	  new WOW().init();
	  $(document).ready(function(){ 
	    var userNickname = sessionStorage.getItem('loginUserNickname')+ "님";
	    var userCarNo = sessionStorage.getItem('loginUsercarNo');
	    var userPhoto = sessionStorage.getItem('loginUserPhoto');
      $("#userNickname").html(userNickname);
      $("#thumbnail").attr("src", "../img/member/m-" + userPhoto + ".png");
	 });  
	</script>
	
</head>

<body class="cbp-spmenu-push">
  <div class="main-content">
    <div class=" sidebar" role="navigation">
      <div class="navbar-collapse">
        <nav class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left"
          id="cbp-spmenu-s1">
          <ul class="nav" id="side-menu">
            <li>
              <a href="../main/main.html" class="">
              <i class="fa fa-home nav_icon"></i>Dashboard</a>
            </li>
            <li>
              <a href="../mypage/mypage.html" class="">
              <i class="fa fa-home nav_icon"></i>My page</a>
            </li>
            <li>
              <a href="../garage/garage.html" class="">
              <i class="fa fa-home nav_icon"></i>차량 등록</a>
            </li>
            <li>
              <a href="../refuel/refuel.html" class="">
              <i class="fa fa-home nav_icon"></i>차량 관리</a>
            </li>
            <li>
              <a href="../center/center.html" class="">
              <i class="fa fa-home nav_icon"></i>정 비 소</a>
            </li>
            <li>
              <a href="../goods/goods.html" class="">
              <i class="fa fa-home nav_icon"></i>맞춤 서비스</a>
            </li>
            <li>
              <a href="../community/community.html" class="">
              <i class="fa fa-home nav_icon"></i>커뮤니티</a>
            </li>
          </ul>
        </nav>
      </div>
    </div>

    <div class="sticky-header header-section ">
      <div class="header-left">
        <!--toggle button start-->
        <button id="showLeftPush">
          <img src="../img/main/menu.png">
        </button>
        <!--toggle button end-->
        <!--logo -->
        <div class="logo">
          <a href="../main/main.html">
            <h1>내 차를 부탁해</h1>
            <span>간편, 쉽고, 재밌는 시작!</span>
          </a>
        </div>
      </div>

      <div class="header-right">
        <!-- 로그인 유저 정보 -->
        <div class="profile_details">
          <ul>
	          <li class="dropdown profile_details_drop">
	            <a href="#" class="dropdown-toggle" 
	               data-toggle="dropdown" aria-expanded="false">
	              <div class="profile_img">
	                <span class="prfil-img">
	                  <img id="thumbnail" src="" alt=""> 
	                </span>
	                <div class="user-name">
	                  <p id="userNickname"></p>
	                  <span>안녕하세요.</span>
	                </div>
	                <!-- 빈칸 유지를 위한 아이콘 자리 -->
	                <i class="fa fa-angle-down lnr"></i> 
	                <i class="fa fa-angle-up lnr"></i>
	                <div class="clearfix"></div>
	              </div>
	            </a>
	            <ul class="dropdown-menu drp-mnu">
	              <li><a id="Mypage" href="#"><i class="fa fa-cog"></i>Mypage</a></li>
	              <li><a id="Logout" href="#"><i class="fa fa-sign-out"></i>Logout</a></li>
	            </ul>
	          </li>
          </ul>
        </div>
        <div class="clearfix"></div>
      </div>
      <div class="clearfix"></div>
    </div>
    <!-- //header-ends -->
    <script>
    $('#Mypage').click(function(event){
        location.href = "../mypage/mypage.html";
    });
    
    $('#Logout').click(function(event){
        event.preventDefault();
        sessionStorage.removeItem('loginUserNickname');
        sessionStorage.removeItem('loginUsercarNo');
        sessionStorage.removeItem('loginUserPhoto');
        location.href = "../auth/login.html";
      });
    </script>

    <div id="page-wrapper">
      <div class="main-page">
	      <div class="container" id="container">
	      </div>
      </div>
        
        
    </div>
    </div>
    
    <div class="footer">
      <p>
        &copy; 2016 Java76th 태웅 재한 영호 다인. All Rights Reserved | Project by <a href="" target="_blank">내 차를 부탁해</a>
      </p>
    </div>
  </div>

  <script>
    var menuLeft = document.getElementById('cbp-spmenu-s1'), 
        showLeftPush = document.getElementById('showLeftPush'), 
        body = document.body;

    showLeftPush.onclick = function() {
      classie.toggle(this, 'active');
      classie.toggle(body, 'cbp-spmenu-push-toright');
      classie.toggle(menuLeft, 'cbp-spmenu-open');
      disableOther('showLeftPush');
    };

    function disableOther(button) {
      if (button !== 'showLeftPush') {
        classie.toggle(showLeftPush, 'disabled');
      }
    }
    
    $.getJSON('../community/ajax/list.do', function(resultObj) {
    	  var container = $("#container");
    	  for (var board of resultObj.data) {
    	    $("<div class='item block' data-bgimage='images/1.jpg'>")
    	      .html("<div class='thumbs-wrapper'>" +
    	    		      "<div class='thumbs'>" +
    	    		        "<img src='../img/community/thumbs/1.jpg'/>" +
    	    	          "<img src='../img/community/thumbs/2.jpg'/>" +
    	    	        "</div>" +
    	    	      "</div>" +
    	    	      "<h2 class='title'>"+ board.title + "</h2>" +
    	    	      "<p class='subline'>" + board.category + "<span class='fancy'>&amp;</span>" + board.memberNo + "</p>"
    	    		  )
    	      .appendTo(container);
    	  }
    	  
    	  $(window).load(function(){
    	        
              // the main container
            var $GPContainer  = $('#container'),
              // the articles (the thumbs)
              $articles   = $GPContainer.children('div.block'),
              // total number of articles
              totalArticles = $articles.length,
              // the fullview container
              $fullview   = $('<div id="fullview" class="full-view-elements"></div>').prependTo( $('body') ),
              // the overlay
              $overlay    = $('<div class="overlay"></div>').prependTo( $('body') ),
              
              GridPortfolio = (function() {
                  // current will be the index of the current article
                var animspeed       = 500,
                  animeasing        = 'jswing', // try easeOutExpo
                  current         = -1,
                  // indicates if certain elements can be animated or not at a given time
                  animrun         = false,
                  init          = function() {
                    initPlugins();
                    initEventsHandler();
                  },
                  // builds each article's carousel
                  // initiallizes the mansory
                  initPlugins       = function() {
                    // apply carousel functionality to the thumbs-wrapper in each article
                    $articles.find('div.thumbs-wrapper').gpCarousel();
                    
                    // apply mansory to the grid items
                    $GPContainer.masonry({
                      itemSelector  : '.item',
                      columnWidth   : 5,
                      isAnimated    : true
                    });
                  },
                  // events
                  initEventsHandler   = function() {
                    // switch to fullview when we click the "View Project" link
                    $articles.each( function(i) {
                      $(this).find('a.more_link').bind('click.GridPortfolio', function(e) {
                        
                        if( animrun ) return false;
                        animrun     = true;
                        
                        var $article  = $(this).closest('div.block');
                        // update the current value
                        current = $article.index('.block');
                        // hide scrollbar
                        $('body').css( 'overflow', 'hidden' );
                        // preload the fullview image and then start the animation (showArticle)
                        var $intro    = $article.find('div.intro');
                        $intro.addClass('intro-loading');
                        $('<img/>').load(function() {
                          $intro.removeClass('intro-loading');
                          showArticle( $article, true );
                          animrun = false;
                        }).attr('src', $article.data('bgimage'));
                        
                        return false;
                      });
                    });
                    
                    // fullview navigation
                    $('#fullview').find('span.full-nav-next').live('click.GridPortfolio', function(e) {
                      if( animrun ) return false;
                      animrun = true;
                      
                      // circular navigation
                      if( current === totalArticles - 1 )
                        current = 0
                      else
                        ++current;
                      // update the fullview current articles number  
                      $fullview.find('span.full-nav-current').html( current + 1 );
                      
                      showFullviewArticle();
                    });
                    $('#fullview').find('span.full-nav-prev').live('click.GridPortfolio', function(e) {
                      if( animrun ) return false;
                      animrun = true;
                      
                      // circular navigation
                      if( current === 0 )
                        current = totalArticles - 1
                      else  
                        --current;
                      // update the fullview current articles number  
                      $fullview.find('span.full-nav-current').html( current + 1 );
                      
                      showFullviewArticle();
                    });
                    
                    // switch to thumbs view
                    $('#fullview').find('span.full-view-exit').live('click.GridPortfolio', function(e) {
                      var $article  = $articles.eq( current );
                      hideArticle( $article );
                    });

                    // window resize 
                    // center the background image if in fullview
                    // reinitialise jscrollpane
                    $(window).bind('resize.GridPortfolio', function(e) {
                      var $bgimage  = $fullview.find('img.bg-img');
                      if( $bgimage.length )
                        centerBgImage( $bgimage );
                        
                      $fullview.find('div.project-descr-full-wrapper').jScrollPane('reinitialise');
                    });
                  },
                  // the clicked article will be cloned;
                  // the clone will be positioned on top of the cloned article;
                  // remove every element from the clone except the thumbs wrapper (basically the image);
                  // enlarge the clone to the window's width & height;
                  // move the thumbs wrapper to the position where the fullview's thumbs wrapper will be placed;
                  // at the same time fade in the overlay;
                  // build the fullview panel with the right data (template)
                  // remove the clone
                  
                  // this function will also be used when we close the fullview article. In this case,
                  // the difference is that we don't animate the values (just set the css values), and the clone is not removed, since we
                  // will use it for the animation (back to the thumb position)
                  showArticle       = function( $article, anim ) {
                    // clone the article
                    var $clone  = $article.clone().css({
                      left  : $article.offset().left + 'px',
                      top   : $article.offset().top + 'px',
                      zIndex  : 1001,
                      margin  : '0px',
                      height  : $article.height() + 'px'
                    }).attr( 'id', 'article-clone' );
                    
                    // this is the images container which is going to "fly" down
                    var $thumbsWrapper  = $clone.find('div.thumbs-wrapper');
                    
                    // remove unnecessary elements from the clone
                    $clone.children().not($thumbsWrapper).remove();
                    $clone.find('div.thumbs-nav').remove();
                    
                    // position the clone on top of the article with the right css style
                    var padding = 20 + 20;
                    // animate?
                    $.fn.applyStyle = ( anim ) ? $.fn.animate : $.fn.css;
                    
                    var clonestyle  = {
                      width : $(window).width() - padding + 'px',
                      height  : $(window).height() - padding + 'px',
                      left  : '0px',
                      top   : $(window).scrollTop() + 'px'
                    };
                    
                    $clone.appendTo( $('body') ).stop().applyStyle( clonestyle, $.extend( true, [], { duration : animspeed, easing : animeasing, complete : function() {
                      // show the panel (it will be hidden behing the clone though, until this one is removed)
                      $fullview.show()
                      
                      // use the template "fullviewTmpl" to build the fullview panel with the right data
                      var articleFullviewData   = getArticleFullviewData($article);
                      articleFullviewData.current = current + 1;
                      articleFullviewData.total = totalArticles;
                      var $fullview_content = $('#fullviewTmpl').tmpl( articleFullviewData );
                      
                      $fullview_content.appendTo( $fullview );
                      
                      // call the gpCarousel plugin on the fullview thumbs-wrapper
                      $fullview_content.find('div.thumbs-wrapper').gpCarousel({
                        start : $article.find('div.thumbs-wrapper').data('currentImage')
                      });
                      
                      //jscrollpane
                      $fullview_content.find('div.project-descr-full-wrapper').jScrollPane('destroy').jScrollPane({
                        verticalDragMinHeight: 40,
                        verticalDragMaxHeight: 40
                      });
                      
                      // center bg image
                      centerBgImage( $fullview.find('img.bg-img') );
                      
                      // fade out overlay
                      $overlay.stop().css( 'opacity', 0 );
                      
                      // fade out clone to show the fullview panel. After that remove the clone
                      $clone.fadeOut( 300, function() { $clone.remove(); } );
                    }}));
                    
                    // animate the images container to the position where is going to be on fullview
                    var thumbsstyle   = {
                      left  : $(window).width() - $thumbsWrapper.width() - 25 + 'px',  // 25 is the margin left / right of the fullview thumbs-wrapper
                      top   : ($(window).height() / 2) - ($thumbsWrapper.height() / 2) - 22 + 'px' // 10 is the margin top / bottom of the fullview thumbs-wrapper
                    };
                    $thumbsWrapper.stop().applyStyle( thumbsstyle, $.extend( true, [], { duration : animspeed, easing : animeasing} ) );
                    
                    // fade in overlay
                    ( anim ) ? $overlay.show().fadeTo( animspeed, 0.7, animeasing ) : $overlay.show().css( 'opacity', 0.7 );
                  },
                  // close the fullview
                  hideArticle       = function( $article ) {
                    // create the article's clone. the second argument is false to prevent the clone to be removed
                    showArticle( $article, false );
                    // hide the overlay for now
                    $overlay.hide();
                    // reference to the created clone and its thumbs wrapper
                    var $clone      = $('#article-clone'),
                      $thumbsWrapper  = $clone.find('div.thumbs-wrapper');
                    // fade in the clone
                    $clone.hide().fadeIn( 200, function() {
                      // remove the contents of the fullview container
                      $fullview.empty();
                      // animate the clone to the article position and size
                      $(this).animate({
                        left  : $article.offset().left + 'px',
                        top   : $article.offset().top + 'px',
                        width : $article.width() + 'px',
                        height  : $article.height() + 'px'
                      }, animspeed, animeasing, function() {
                        // remove the clone
                        $clone.remove();
                        // show the scrollbar
                        $('body').css( 'overflow', 'visible' );
                      });
                      
                      // animate the clone's thumbs wrapper so it moves to the article's thumbs wrapper position
                      $thumbsWrapper.animate({
                        left  : '0px',
                        top   : '0px'
                      }, animspeed, animeasing);
                      
                      // fade out the overlay
                      $overlay.show().fadeTo( animspeed, 0, animeasing, function() { $overlay.hide() } );
                    });
                  },
                  // gets the article's necessary info to build the fullview panel
                  getArticleFullviewData  = function( $article ) {
                    return {
                      bgimage     : '<img src="' + $article.data('bgimage') + '" class="bg-img"></img>',
                      title       : $article.find('h2.title').text(),
                      thumbs      : $article.find('div.thumbs').html(),
                      subline     : $article.find('p.subline').text(),
                      description   : $article.find('div.project-descr').html()
                    }
                  },
                  // used when navigating in fullview
                  // needs to get the next / previous article's info
                  showFullviewArticle   = function() {
                    var $article          = $articles.eq( current ),
                      articleFullviewData     = getArticleFullviewData($article),
                    
                      $loading          = $fullview.find('span.loading-small'),
                    
                      $fullviewImage        = $fullview.find('img.bg-img'),
                    
                      $fullviewTitle        = $fullview.find('h2.title'),
                      
                      $fullviewSubline      = $fullview.find('p.subline'),
                      
                      $fullviewDescriptionWrapper = $fullview.find('div.project-descr-full-wrapper'),
                      $fullviewDescription    = $fullviewDescriptionWrapper.find('div.project-descr-full-content'),
                      
                      $fullviewProjectDescrFull = $fullview.find('div.project-descr-full'),
                      $fullviewThumbsWrapper    = $fullviewProjectDescrFull.find('div.thumbs-wrapper'),
                      $newFullviewThumbsWrapper = $('<div class="thumbs-wrapper"><div class="thumbs">' + articleFullviewData.thumbs + '</div></div>');
                    
                    // preload the article's background image
                    $loading.show();
                    $( articleFullviewData.bgimage ).load(function() {
                      $loading.hide();
                      var $bgImage  = $(this);
                      $bgImage.insertBefore( $fullviewImage );
                      // center the bg image
                      centerBgImage( $bgImage );
                      $fullviewImage.remove(); 
                      
                      $fullviewTitle.html( articleFullviewData.title );
                      
                      $fullviewSubline.html( articleFullviewData.subline );
                      
                      $fullviewDescriptionWrapper.jScrollPane('destroy');
                      $fullviewDescription.html( articleFullviewData.description );
                      $fullviewDescriptionWrapper.jScrollPane('destroy').jScrollPane({
                        verticalDragMinHeight: 40,
                        verticalDragMaxHeight: 40
                      });
                      
                      $fullviewThumbsWrapper.remove();
                      $fullviewProjectDescrFull.prepend( $newFullviewThumbsWrapper ); 
                      $newFullviewThumbsWrapper.gpCarousel();
                      
                      animrun = false;
                    }).attr('src', $article.data('bgimage'));
                    
                  },
                  // centers the background image
                  centerBgImage     = function( $img ) {
                    var dim = getImageDim($img);
                    //set the returned values and show the image
                    $img.css({
                      width : dim.width + 'px',
                      height  : dim.height + 'px',
                      left  : dim.left + 'px',
                      top   : dim.top + 'px'
                    });
                  },
                  //get dimentions of the image,
                  //in order to make it full size and centered
                  getImageDim       = function($i) {
                    var $img     = new Image();
                    $img.src     = $i.attr('src');
                        
                    var w_w = $(window).width(),
                    w_h = $(window).height(),
                    r_w = w_h / w_w,
                    i_w = $img.width,
                    i_h = $img.height,
                    r_i = i_h / i_w,
                    new_w,new_h,
                    new_left,new_top;
                        
                    if(r_w > r_i){
                      new_h = w_h;
                      new_w = w_h / r_i;
                    }
                    else{
                      new_h = w_w * r_i;
                      new_w = w_w;
                    }
                        
                    return {
                      width : new_w,
                      height  : new_h,
                      left  : (w_w - new_w) / 2,
                      top   : (w_h - new_h) / 2
                    };
                        
                  };
                
                return {
                  init  : init
                };
                
              })()
            
            GridPortfolio.init();
            
          });
    	  
    	  // 제목 링크에 클릭 이벤트 리스너를 등록한다.
    	  /* $("a.detailLnk").click(clickDetailLnk); */
    	});
    
/* 
    	$('#newBtn').click(function(event){
    	  location.href = "form.html?no=-1";
    	});

    	// 게시물 제목을 클릭했을 때 호출될 함수
    	function clickDetailLnk(event) {
    	  event.preventDefault(); 
    	  location.href = "form.html?no=" + $(event.target).attr("boardNo");
    	}
 */    	
  </script>
</body>
</html>